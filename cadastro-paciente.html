<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Cadastro de Paciente</title>
  <link rel="stylesheet" href="global.css" />
</head>
<body>

  <div class="container">
    <h1>Cadastro de Paciente</h1>

    <form id="formPaciente" class="card">
      <label>
        Nome completo
        <input type="text" id="nome" required />
      </label>

      <label>
        CPF
        <input type="text" id="cpf" />
      </label>

      <label>
        Telefone
        <input type="text" id="telefone" />
      </label>

      <label>
        Email
        <input type="email" id="email" />
      </label>

      <label>
        Data de nascimento
        <input type="date" id="dataNascimento" />
      </label>

      <div class="actions">
        <button type="submit" class="btn-primary">Salvar</button>
        <button type="button" class="btn-secondary" onclick="history.back()">Voltar</button>
      </div>
    </form>
  </div>

  <!-- Supabase -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

  <script>
    const supabase = supabase.createClient(
      'SUA_URL_SUPABASE',
      'SUA_ANON_KEY'
    )

    document.getElementById('formPaciente').onsubmit = async e => {
      e.preventDefault()

      const paciente = {
        nome: document.getElementById('nome').value,
        cpf: document.getElementById('cpf').value,
        telefone: document.getElementById('telefone').value,
        email: document.getElementById('email').value,
        data_nascimento: document.getElementById('dataNascimento').value
      }

      const { error } = await supabase
        .from('paciente')
        .insert([paciente])

      if (error) {
        alert('Erro ao cadastrar paciente')
        console.error(error)
        return
      }

      alert('Paciente cadastrado com sucesso!')
      window.location.href = 'novo-atendimento.html'
    }
  </script>

</body>
</html>

